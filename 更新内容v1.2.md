# 📋 更新内容 バージョン 1.2

## 🎉 最新版（v1.2）- 2025年11月4日

### ✨ 主な変更点

#### 1. 📝 **入力フォームを大幅改善**

**旧バージョン:**
- 店舗名 / 氏名（1つの入力欄）
- コメント欄

**新バージョン（v1.2）:**
- **店番（8桁）** - 必須、数字8桁のみ
- **店舗名** - 必須
- **氏名** - 必須
- **店舗目標金額** - 必須、1,000円単位で入力
- **販売日** - 必須
- **販売数量**（22錠・48錠・84錠）

#### 2. 🏆 **ランキングを達成率順に変更**

**旧: 売上金額順**
```
1位: 東京支店 - ¥100,000
2位: 大阪支店 - ¥80,000
3位: 名古屋支店 - ¥60,000
```

**新: 達成率順**
```
1位: 大阪支店 - 120.0%（目標¥50,000 / 売上¥60,000）
2位: 東京支店 - 100.0%（目標¥100,000 / 売上¥100,000）
3位: 名古屋支店 - 85.7%（目標¥70,000 / 売上¥60,000）
```

#### 3. 💯 **達成率の視覚化**

- **100%以上**: 緑色（達成！）
- **80%以上**: オレンジ色（もう少し）
- **80%未満**: 赤色（要努力）

---

## 📱 画面表示イメージ

### 入力フォーム

```
┌─────────────────────────────────┐
│ 📝 入力                         │
├─────────────────────────────────┤
│                                 │
│ 店番（8桁） *                   │
│ [12345678____________]          │
│                                 │
│ 店舗名 *                        │
│ [東京中央店___________]         │
│                                 │
│ 氏名 *                          │
│ [山田太郎____________]          │
│                                 │
│ 店舗目標金額 *                  │
│ [100000______________] 円       │
│                                 │
│ 販売日 *                        │
│ [2025-11-04__________]          │
│                                 │
│ 販売数量                        │
│ ┌──────┐ ┌──────┐ ┌──────┐    │
│ │22錠  │ │48錠  │ │84錠  │    │
│ │  5   │ │  3   │ │  2   │    │
│ └──────┘ └──────┘ └──────┘    │
│                                 │
│ [📤 登録する]                   │
│                                 │
└─────────────────────────────────┘
```

### ランキング表示

```
┌────────────────────────────────────────────┐
│ 🏆 販売ランキング（達成率順）              │
├────────────────────────────────────────────┤
│                                            │
│ 🥇 1  [店番: 12345678] 大阪支店 / 佐藤花子│
│       22錠: 10個 (¥19,800)                 │
│       48錠: 8個 (¥31,840)                  │
│       84錠: 5個 (¥29,900)                  │
│       📅 最終販売日: 2025-11-04            │
│       🎯 目標: ¥50,000 | 売上: ¥81,540    │
│                                            │
│                           163.1%           │
│                           達成率           │
│                        （緑色で表示）      │
│                                            │
│ 🥈 2  [店番: 87654321] 東京中央店 / 田中太郎│
│       22錠: 15個 (¥29,700)                 │
│       48錠: 10個 (¥39,800)                 │
│       84錠: 8個 (¥47,840)                  │
│       📅 最終販売日: 2025-11-04            │
│       🎯 目標: ¥100,000 | 売上: ¥117,340  │
│                                            │
│                           117.3%           │
│                           達成率           │
│                        （緑色で表示）      │
│                                            │
│ 🥉 3  [店番: 11223344] 名古屋店 / 鈴木一郎│
│       22錠: 8個 (¥15,840)                  │
│       48錠: 5個 (¥19,900)                  │
│       84錠: 3個 (¥17,940)                  │
│       📅 最終販売日: 2025-11-03            │
│       🎯 目標: ¥70,000 | 売上: ¥53,680    │
│                                            │
│                           76.7%            │
│                           達成率            │
│                       （赤色で表示）       │
│                                            │
└────────────────────────────────────────────┘
```

---

## 🔧 技術的な変更

### データ構造の変更

**旧バージョン:**
```javascript
{
  storeName: "東京支店 / 山田太郎",
  date: "2025-11-04",
  qty22: 5,
  qty48: 3,
  qty84: 2,
  comment: "キャンペーン実施"
}
```

**新バージョン（v1.2）:**
```javascript
{
  storeCode: "12345678",
  storeName: "東京中央店",
  userName: "山田太郎",
  targetAmount: 100000,
  date: "2025-11-04",
  qty22: 5,
  qty48: 3,
  qty84: 2
}
```

### ソート（並び替え）ロジック

**旧:**
```javascript
// 売上金額でソート
const rankings = storeStats.sort((a, b) => b.totalSales - a.totalSales);
```

**新:**
```javascript
// 達成率でソート
const rankings = storeStats.sort((a, b) => {
  const rateA = a.targetAmount > 0 ? (a.totalSales / a.targetAmount) : 0;
  const rateB = b.targetAmount > 0 ? (b.totalSales / b.targetAmount) : 0;
  return rateB - rateA;
});
```

---

## 📊 達成率の計算式

```
達成率(%) = (実際の売上金額 ÷ 目標金額) × 100

例:
目標: ¥100,000
売上: ¥120,000
達成率 = (120,000 ÷ 100,000) × 100 = 120.0%
```

---

## 🎨 色分けルール

### 達成率による色分け

| 達成率 | 色 | 意味 |
|--------|------|------|
| **100%以上** | 🟢 緑色 `#4CAF50` | 目標達成！素晴らしい！ |
| **80%以上** | 🟠 オレンジ `#FF9800` | あと少し！頑張れ！ |
| **80%未満** | 🔴 赤色 `#f44336` | 要努力！ファイト！ |

---

## 🔄 既存データとの互換性

### ⚠️ 重要なお知らせ

**旧バージョンのデータは達成率0%と表示されます**

理由:
- 旧データには `targetAmount`（目標金額）が含まれていない
- 目標金額が0の場合、達成率は計算できない

### 対処法

**方法1: 新しいデータを入力し直す（推奨）**
- 一番確実
- 店番・目標金額を含めて再入力

**方法2: ブラウザのローカルストレージをクリア**
```javascript
// ブラウザのコンソールで実行
localStorage.clear();
location.reload();
```

**方法3: 旧データは参考値として残す**
- そのまま運用開始
- 新しいデータが蓄積されれば、旧データの影響は小さくなる

---

## 🚀 アップデート手順

### すでにGitHubで公開している場合

1. **新しいindex.htmlをダウンロード**
   ```bash
   # AI Driveから取得
   /mnt/aidrive/ユンケル販売コンクール/index.html
   ```

2. **GitHubにアップロード**
   - 「Add file」→「Upload files」
   - 既存のindex.htmlを上書き

3. **ブラウザでキャッシュクリア**
   - Windows: Ctrl + F5
   - Mac: Cmd + Shift + R

4. **動作確認**
   - 新しい入力フォームが表示されるか確認
   - テストデータを入力
   - ランキングが達成率順になっているか確認

---

## 💡 使い方のヒント

### 目標金額の設定

**推奨設定方法:**
- **月間目標**: 月の目標売上を入力
- **期間目標**: コンクール期間の目標を入力
- **適正金額**: 実現可能な範囲で設定

**例:**
- 小規模店: ¥50,000〜¥100,000
- 中規模店: ¥100,000〜¥200,000
- 大規模店: ¥200,000〜¥500,000

### 店番の入力

- 必ず8桁の数字で入力
- 店番がない場合は、仮の番号を設定
  - 例: 00000001, 00000002, 00000003...

---

## ❓ よくある質問

**Q1: 目標金額は後から変更できますか？**
A: はい、新しいデータを入力する際に更新された目標金額を入力すれば、最新の値が使用されます。

**Q2: 店番を間違えて入力してしまいました**
A: データは店番でグループ化されるため、正しい店番で入力し直してください。間違ったデータは無視されます。

**Q3: 達成率100%超えの場合はどうなりますか？**
A: 緑色で表示され、目標を上回ったことが一目でわかります！

**Q4: 達成率順ではなく売上順にできますか？**
A: JavaScriptのソート部分を変更すれば可能です。詳しくはシステム管理者にお問い合わせください。

**Q5: 旧バージョンのデータはどうなりますか？**
A: 目標金額が0として扱われ、達成率0%と表示されます。

---

## 📞 サポート

ご不明な点やカスタマイズのご要望がございましたら、お気軽にお問い合わせください。

---

## 📦 ファイル情報

**ファイル名**: index.html  
**バージョン**: 1.2  
**更新日**: 2025年11月4日  
**ファイルサイズ**: 約25KB  
**保存場所**: 
- `/mnt/aidrive/ユンケル販売コンクール/index.html`
- `/home/user/sales_contest/index.html`

---

## 🎯 次回の更新予定

- [ ] CSVエクスポート機能
- [ ] 期間フィルター（週別・月別）
- [ ] 目標金額の一括設定機能
- [ ] 達成率グラフの追加
- [ ] 店舗別の詳細レポート

---

**🎉 新しいバージョンで、より効果的な販売コンクールを実現してください！**
